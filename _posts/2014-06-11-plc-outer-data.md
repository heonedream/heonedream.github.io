---
layout: blog
title: PLC 中的字符与直接量
tags: PLC 事件 溢出 编译 字符串
---

IEC 61131-3 中规约了 PLC 语言字符的使用与数据直接量的语法，本文详述了这两部分。

## 字符的使用

文本/图形语言 **字符集** 定义在 ISO-646IRV中，同时有其他字符集的扩展，如 ISO 10646-1 定义的“拉丁-1 补充”。

**标识符** 是由字母、数字、下划线组成的字符串，并且由字母或下划线开始。

* 可编程控制器编程语言是大小写不敏感的。
* 标识符中的下划线是有意义的，然而多个连续的下划线是不允许的。
* 标识符至少应支持6个字符。

**注释** 是在程序中引入文本的语言构造，并且对程序的执行没有影响。在可编程控制器语言中，注释的分隔符为`(*` 和 `*)`。

> 嵌套的注释将被当做 **错误** 。

**编译指示** 是在程序组织单元中引入文本的语言构造，并且可能会对程序执行前的准备产生影响。在可编程控制器语言中，编译指示的分隔符为`{` 和 `}`。

<!--more-->

## 数据的外部表示

### 数字直接量

有两种数字直接量：整数和实数。数字直接量定义为十进制数或其他基底的数。

> 在数字直接量中，插在数字间的单个 `_` 是没有意义的，其他下划线的使用都是不允许的。

示例：

```
-12 0 123_456 +986
-12.0 0.0 0.4560 3.14159_26
-1.34E-12 or -1.34e-12
16#FF or 16#ff (十进制255)
FALSE TRUE
UINT#16#9AF DINT#5
```

### 字符串直接量

字符串直接量包括单字节和双字节编码的字符。

**单字符** 字符串以`'`分隔，`$`与随后的两位16进制数表示8位字符码。 **双字节** 字符串以`"`分隔，`$`与随后的4四位16进制数表示16位字符码。`$`与随后的一个字符表示转移。

示例：

```
''  'A' '$''    'Ä Ë' == '$C4$CB'
""  "A" "$""    "Ä Ë" == "$00C4$00CB"
STRING#'OK' == WSTRING#'OK'
```

转义列表

组合     |   解释
---             |   ---
`$$`            |   美元符号
`$'`/`$"`    |   引号
`$L`/`$l`    |   换行
`$N`/`$n`    |   新行 
`$P`/`$p`    |   换页
`$R`/`$r`    |   回车
`$T`/`$t`    |   制表符

### 时间直接量

有两类的时间直接量：

1. **持续时间** 来度量或控制一个控制事件消耗的时间。
2. **时间点** （可以包括日期）来同步控制事件的开始或结束。

* 可选的单个`_`可以用来分隔不同的时间单位。
* 持续时间的最大单位允许“溢出。
* 最小单位可以是不含指数的实数。

关键字    |   持续时间    |   时间点
---         |   ---         |   ---
全拼        | `TIME`        |   `DATE` `TIME_OF_DAY` `DATE_AND_TIME`
简写        |   `T`         |   `D` `TOD` `DT`

示例：

```
T#14.7h t#5d14h12m18s3.5ms  TIME#-14ms
DATE#1984-06-25 tod#15:36:55.36
date_and_time#1984-06-25-15:36:55.36
```

